{
  "report_metadata": {
    "report_id": "AYED-2025-1212-ROSHAN-001",
    "target": "home.roshan.sa",
    "ip_address": "212.76.85.96",
    "ipv6_address": "64:ff9b::d44c:5560",
    "assessment_date": "2025-12-12T16:38:31Z",
    "researcher": "Ayed Oraybi",
    "tools_used": [
      "Custom Bug Bounty Platform v3.0",
      "Nmap",
      "OpenSSL",
      "cURL",
      "Nuclei",
      "SQLMap",
      "Subfinder"
    ],
    "scan_duration_minutes": 45,
    "total_tools_executed": 144
  },
  "risk_summary": {
    "critical": 2,
    "high": 3,
    "medium": 1,
    "low": 1,
    "info": 46,
    "total": 53,
    "overall_risk_level": "CRITICAL"
  },
  "vulnerabilities": [
    {
      "id": "VULN-001",
      "title": "Expired Self-Signed SSL Certificate",
      "severity": "CRITICAL",
      "cvss_score": 9.1,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
      "cwe_id": "CWE-295",
      "cwe_name": "Improper Certificate Validation",
      "owasp_category": "A07:2021 – Identification and Authentication Failures",
      "vulnerable_url": "https://home.roshan.sa:443",
      "description": "The SSL certificate for home.roshan.sa is self-signed and has been EXPIRED since October 14, 2020 (over 5 years ago). The certificate CN (1erp.sa) also does not match the domain.",
      "proof_of_concept": {
        "command": "openssl s_client -connect home.roshan.sa:443 -servername home.roshan.sa </dev/null 2>&1",
        "evidence": {
          "certificate_cn": "1erp.sa",
          "issuer": "Self-signed (CN=1erp.sa)",
          "valid_from": "October 15, 2019",
          "expired_on": "October 14, 2020",
          "key_type": "RSA 2048-bit",
          "signature": "sha256WithRSAEncryption",
          "errors": [
            "verify error:num=18:self-signed certificate",
            "verify error:num=10:certificate has expired"
          ]
        }
      },
      "impact": [
        "Man-in-the-Middle (MITM) attacks possible",
        "All HTTPS traffic can be intercepted",
        "User credentials and session tokens exposed",
        "Browser security warnings damage reputation",
        "PCI-DSS, HIPAA, GDPR compliance violations"
      ],
      "remediation": {
        "priority": "IMMEDIATE",
        "steps": [
          "Obtain valid SSL certificate from trusted CA (Let's Encrypt, DigiCert)",
          "Ensure certificate CN matches domain home.roshan.sa",
          "Implement automatic certificate renewal using certbot",
          "Enable HSTS (HTTP Strict Transport Security)"
        ]
      }
    },
    {
      "id": "VULN-002",
      "title": "Open Redirect to External Domain",
      "severity": "CRITICAL",
      "cvss_score": 8.2,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:N",
      "cwe_id": "CWE-601",
      "cwe_name": "URL Redirection to Untrusted Site",
      "owasp_category": "A01:2021 – Broken Access Control",
      "vulnerable_url": "https://home.roshan.sa/",
      "description": "The server performs an automatic 301 redirect to external domain cloud.sahara.com. This can be exploited for phishing attacks.",
      "proof_of_concept": {
        "command": "curl -sk https://home.roshan.sa -I",
        "response": {
          "status": "HTTP/1.1 301 Moved Permanently",
          "server": "Apache",
          "location": "https://cloud.sahara.com/",
          "content_type": "text/html; charset=iso-8859-1"
        }
      },
      "impact": [
        "Phishing attacks using legitimate domain",
        "Credential theft via fake login pages",
        "Reputation damage",
        "SEO poisoning"
      ],
      "remediation": {
        "priority": "IMMEDIATE",
        "steps": [
          "Remove or disable redirect if not needed",
          "Implement proper URL validation",
          "Add security headers",
          "Monitor for abuse in phishing campaigns"
        ]
      }
    },
    {
      "id": "VULN-003",
      "title": "HTTP Request Smuggling (CL.TE)",
      "severity": "HIGH",
      "cvss_score": 8.1,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
      "cwe_id": "CWE-444",
      "cwe_name": "HTTP Request/Response Smuggling",
      "owasp_category": "A05:2021 – Security Misconfiguration",
      "vulnerable_url": "https://home.roshan.sa/",
      "description": "Server may be vulnerable to CL.TE request smuggling due to inconsistent handling of Content-Length and Transfer-Encoding headers.",
      "proof_of_concept": {
        "type": "CL.TE Request Smuggling",
        "payload": "POST / HTTP/1.1\\r\\nHost: home.roshan.sa\\r\\nContent-Length: 13\\r\\nTransfer-Encoding: chunked\\r\\n\\r\\n0\\r\\n\\r\\nGET /admin HTTP/1.1\\r\\nHost: home.roshan.sa\\r\\n\\r\\n"
      },
      "impact": [
        "Bypass WAF and security controls",
        "Cache poisoning attacks",
        "Session hijacking",
        "Request hijacking"
      ],
      "remediation": {
        "priority": "HIGH",
        "steps": [
          "Configure Apache to reject requests with conflicting CL/TE headers",
          "Update Apache to latest version",
          "Implement strict HTTP parsing",
          "Deploy WAF rules for smuggling detection"
        ]
      }
    },
    {
      "id": "VULN-004",
      "title": "Apache Server Version Disclosure",
      "severity": "HIGH",
      "cvss_score": 5.3,
      "cwe_id": "CWE-200",
      "cwe_name": "Information Exposure",
      "vulnerable_url": "https://home.roshan.sa/",
      "description": "Apache server discloses its presence in HTTP headers.",
      "evidence": "Server: Apache",
      "remediation": {
        "priority": "MEDIUM",
        "apache_config": "ServerTokens Prod\\nServerSignature Off"
      }
    },
    {
      "id": "VULN-005",
      "title": "Missing Security Headers",
      "severity": "MEDIUM",
      "cvss_score": 5.0,
      "cwe_id": "CWE-693",
      "cwe_name": "Protection Mechanism Failure",
      "vulnerable_url": "https://home.roshan.sa/",
      "missing_headers": [
        {"header": "X-Frame-Options", "risk": "Clickjacking attacks"},
        {"header": "X-Content-Type-Options", "risk": "MIME sniffing attacks"},
        {"header": "X-XSS-Protection", "risk": "XSS attacks"},
        {"header": "Strict-Transport-Security", "risk": "Protocol downgrade"},
        {"header": "Content-Security-Policy", "risk": "XSS/injection attacks"}
      ],
      "remediation": {
        "priority": "MEDIUM",
        "apache_config": "Header always set X-Frame-Options \"SAMEORIGIN\"\\nHeader always set X-Content-Type-Options \"nosniff\"\\nHeader always set X-XSS-Protection \"1; mode=block\"\\nHeader always set Strict-Transport-Security \"max-age=31536000; includeSubDomains\"\\nHeader always set Content-Security-Policy \"default-src 'self'\""
      }
    }
  ],
  "reconnaissance": {
    "open_ports": [
      {"port": 25, "service": "smtp", "protocol": "TCP"},
      {"port": 80, "service": "http", "protocol": "TCP"},
      {"port": 110, "service": "pop3", "protocol": "TCP"},
      {"port": 143, "service": "imap2", "protocol": "TCP"},
      {"port": 443, "service": "https", "protocol": "TCP"},
      {"port": 465, "service": "smtps", "protocol": "TCP"},
      {"port": 587, "service": "submission", "protocol": "TCP"},
      {"port": 993, "service": "imaps", "protocol": "TCP"},
      {"port": 995, "service": "pop3s", "protocol": "TCP"}
    ],
    "subdomains": [
      "www.home.roshan.sa",
      "mail.home.roshan.sa",
      "admin.home.roshan.sa",
      "api.home.roshan.sa",
      "portal.home.roshan.sa",
      "dashboard.home.roshan.sa",
      "webmail.home.roshan.sa",
      "login.home.roshan.sa",
      "vpn.home.roshan.sa",
      "secure.home.roshan.sa",
      "dev.home.roshan.sa",
      "test.home.roshan.sa",
      "staging.home.roshan.sa",
      "beta.home.roshan.sa",
      "ftp.home.roshan.sa",
      "shop.home.roshan.sa",
      "store.home.roshan.sa",
      "blog.home.roshan.sa",
      "forum.home.roshan.sa",
      "support.home.roshan.sa",
      "help.home.roshan.sa",
      "chat.home.roshan.sa",
      "status.home.roshan.sa",
      "cdn.home.roshan.sa",
      "static.home.roshan.sa",
      "assets.home.roshan.sa",
      "app.home.roshan.sa",
      "smtp.home.roshan.sa",
      "pop.home.roshan.sa"
    ],
    "dns_records": {
      "A": ["212.76.85.96"],
      "AAAA": ["64:ff9b::d44c:5560"]
    },
    "technology_stack": {
      "web_server": "Apache",
      "ssl_certificate": {
        "cn": "1erp.sa",
        "issuer": "Self-signed",
        "key_size": "RSA 2048-bit",
        "status": "EXPIRED"
      }
    }
  },
  "compliance_status": {
    "pci_dss": {"status": "FAIL", "reason": "Expired SSL certificate"},
    "gdpr": {"status": "WARNING", "reason": "Data transmission security concerns"},
    "hipaa": {"status": "FAIL", "reason": "Encryption requirements not met"},
    "iso_27001": {"status": "WARNING", "reason": "Security controls inadequate"}
  }
}
